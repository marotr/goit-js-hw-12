{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["const images = {\n\tmethod: \"GET\"\n};\nexport function createMarkup(arr) {\nreturn arr.map(({ webformatURL, tags, largeImageURL, likes, views, comments, downloads }) => {\n           return ` <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\" >\n          <img class=\"gallery-image\"\n           src=\"${webformatURL}\" \n           alt=\"${tags}\" \n           width = \"360\"/>\n          <ul class=\"card-descr\">\n           <li class=\"card-element\"><span class=\"label\">Likes</span> <p class =\"value\">${likes}</p></li>\n            <li class=\"card-element\"><span class=\"label\">Views</span> <p class =\"value\">${views}</p></li>\n            <li class=\"card-element\"><span class=\"label\">Comments</span> <p class =\"value\">${comments}</p></li>\n            <li class=\"card-element\"><span class=\"label\">Downloads</span><p class =\"value\">${downloads}</p></li></ul>\n        </a>\n      </li>`\n            \n        }).join(\"\");\n}\n\n","import axios from 'axios';\nconst API_KEY = \"43193709-9f2e77a8cd9049868dd3fabee\"\nexport async function serviceImage(image, page = \"1\") {\n\n    const parameters = {\n      key: API_KEY,\n      q: image,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page,\n      per_page: 150\n    };\n \n  try {\n    const response = await axios.get(\"https://pixabay.com/api/\", {\n      params: parameters\n    });\n \n  \n    if (response.status !== 200) {\n      throw new Error(response.statusText);\n    }\n    return response.data;\n  }\n  catch (error) {\n    throw error;\n    \n  }\n}\n  \n\n\n\n\n\n\n  \n\n\n\n\n\n    \n\n  \n  \n \n\n\n","\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { createMarkup } from \"./js/render-functions\";\nimport { serviceImage } from \"./js/pixabay-api\";\n\n\n\n\nconst searchImage = document.querySelector('.search-form');\nconst galleryList = document.querySelector('.gallery');\nconst button = document.querySelector('.search-btn');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.load-more')\nloadBtn.addEventListener(\"click\", loadMore)\n\nbutton.addEventListener(\"click\", handleSearch);\n\nconst searchInput = document.querySelector(\".search-form input\");\nsearchInput.addEventListener(\"input\", () => {\n  page = 1;\n  galleryList.innerHTML = '';\n  \n});\nsearchImage.addEventListener(\"submit\", handleSearch);\n\nlet page = 1; \nlet currentKeyword = '';\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\nfunction handleSearch(evt) {\n  \n  evt.preventDefault();\n  const imageInput = document.querySelector(\".search-form input\");\n currentKeyword = imageInput.value.trim();\n  if (currentKeyword === '') {\n      iziToast.show({\n          message: \"Please enter a search query\",\n          messageColor: ' #fff',\n          backgroundColor: '#ef4040',\n          position: 'topCenter',\n          messageSize: '16px',\n          messageLineHeight: '150%',\n          iconColor:'white'\n        });\n        return; \n    }\n\n showLoader();\n  galleryList.innerHTML = '';\n\n \n\n  serviceImage(currentKeyword)\n    .then(data => { \n      if (data.hits.length === 0) {\n        iziToast.show({\n          message: \"Sorry, there are no images matching your search query. Please try again!\",\n          messageColor: ' #fff',\n          backgroundColor: '#ef4040',\n          position: 'topCenter',\n          messageSize: '16px',\n          messageLineHeight: '150%',\n          iconColor:'white'\n        });\n      } else {\n     \n          galleryList.innerHTML = createMarkup(data.hits);\n          const lightboxOptions = {\n    captionDelay: 250,\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n};\n\nconst lightbox = new SimpleLightbox('.gallery a', lightboxOptions);\n        lightbox.refresh();\n       \nconst perPage = 15;\nconst totalPages = Math.ceil(data.total / perPage);\n\n\nif (page < totalPages) { \n  loadBtn.classList.replace(\"load-hidden\", \"load-more\");\n}   \n      }\n    })\n      .catch(error => {\n        galleryList.innerHTML = '';\n      iziToast.show({\n        message: \"An error occurred while fetching images. Please try again later.\",\n        messageColor: ' #fff',\n        backgroundColor: '#ef4040',\n        position: 'topCenter',\n        messageSize: '16px',\n        messageLineHeight: '150%',\n        iconColor:'white'\n      });\n    })\n      .finally(() => {\n     hideLoader();\n      searchImage.reset();\n    });\n}\n\nasync function loadMore() {\n\n    showLoader();\n    loadBtn.disabled = true;\n    \n    try {\n        page++; \n        const data = await serviceImage(currentKeyword, page);\n        \n        if (data && data.hits && data.hits.length > 0) {\n            galleryList.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n          toggleLoadButton(data.totalHits);\n          \n          smoothScrollToNextGroup()\n\n           \n        } else {\n          loadBtn.style.display = \"none\"; \n         \n          iziToast.show({\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                    messageColor: '#fff',\n                    backgroundColor: '#ef4040',\n                    position: 'topCenter',\n                    messageSize: '16px',\n                    messageLineHeight: '150%',\n                    iconColor: 'white'\n                });\n        }\n   \n    } catch (error) {\n     \n       loadBtn.style.display = \"none\";\n        iziToast.show({\n            message: \"That is the end of the search\",\n            messageColor: ' #fff',\n            backgroundColor: '#ef4040',\n            position: 'topCenter',\n            messageSize: '16px',\n            messageLineHeight: '150%',\n            iconColor: 'white'\n        });\n       \n    } finally {\n      loadBtn.disabled = false;\n        hideLoader();\n    }\n}\n\n\n\nfunction toggleLoadButton(totalHits) {\n  \n  \n  if (page * 15 >= totalHits) {\n    \n    loadBtn.style.display = 'none';\n  } else {\n  \n    loadBtn.style.display = 'block';\n  }\n}\n\n\n\nfunction smoothScrollToNextGroup() {\n    const firstGalleryItem = document.querySelector('.gallery a');\n    if (firstGalleryItem) {\n        const galleryItemHeight = firstGalleryItem.getBoundingClientRect().height;\n        window.scrollBy({\n            top: galleryItemHeight * 2, \n            behavior: 'smooth' \n        });\n    } else {\n        \n    }\n}\n\n\n\n\n\n"],"names":["createMarkup","arr","webformatURL","tags","largeImageURL","likes","views","comments","downloads","API_KEY","serviceImage","image","page","parameters","response","axios","error","searchImage","galleryList","button","loader","loadBtn","loadMore","handleSearch","searchInput","currentKeyword","showLoader","hideLoader","evt","iziToast","data","lightboxOptions","SimpleLightbox","perPage","totalPages","toggleLoadButton","smoothScrollToNextGroup","totalHits","firstGalleryItem","galleryItemHeight"],"mappings":"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"}