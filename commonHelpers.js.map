{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["const images = {\n\tmethod: \"GET\"\n};\nexport function createMarkup(arr) {\nreturn arr.map(({ webformatURL, tags, largeImageURL, likes, views, comments, downloads }) => {\n           return ` <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\" >\n          <img class=\"gallery-image\"\n           src=\"${webformatURL}\" \n           alt=\"${tags}\" \n           width = \"360\"/>\n          <ul class=\"card-descr\">\n           <li class=\"card-element\"><span class=\"label\">Likes</span> <p class =\"value\">${likes}</p></li>\n            <li class=\"card-element\"><span class=\"label\">Views</span> <p class =\"value\">${views}</p></li>\n            <li class=\"card-element\"><span class=\"label\">Comments</span> <p class =\"value\">${comments}</p></li>\n            <li class=\"card-element\"><span class=\"label\">Downloads</span><p class =\"value\">${downloads}</p></li></ul>\n        </a>\n      </li>`\n            \n        }).join(\"\");\n}\n\n","import axios from 'axios';\nconst API_KEY = \"43193709-9f2e77a8cd9049868dd3fabee\"\nexport async function serviceImage(image, page = \"1\") {\n\n    const parameters = {\n      key: API_KEY,\n      q: image,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page,\n      per_page: 15\n    };\n \n  try {\n    const response = await axios.get(\"https://pixabay.com/api/\", {\n      params: parameters\n    });\n \n  \n    if (response.status !== 200) {\n      throw new Error(response.statusText);\n    }\n    return response.data;\n  }\n  catch (error) {\n    throw error;\n    \n  }\n}\n  \n\n\n\n\n\n\n  \n\n\n\n\n\n    \n\n  \n  \n \n\n\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { createMarkup } from \"./js/render-functions\";\nimport { serviceImage } from \"./js/pixabay-api\";\n\nconst searchImage = document.querySelector('.search-form');\nconst galleryList = document.querySelector('.gallery');\nconst button = document.querySelector('.search-btn');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.load-more');\nconst endMsg = document.querySelector('.end-message');\n\nloadBtn.addEventListener(\"click\", loadMore);\nbutton.addEventListener(\"click\", handleSearch);\n\nconst searchInput = document.querySelector(\".search-form input\");\nsearchInput.addEventListener(\"input\", () => {\n  page = 1;\n  galleryList.innerHTML = '';\n  loadBtn.style.display = 'none';\n});\n\nsearchImage.addEventListener(\"submit\", handleSearch);\n\nlet page = 1;\nlet currentKeyword = '';\nendMsg.style.display = 'none';\nloadBtn.style.display = 'none';\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nfunction handleSearch(evt) {\n  evt.preventDefault();\n  const imageInput = document.querySelector(\".search-form input\");\n  currentKeyword = imageInput.value.trim();\n  if (currentKeyword === '') {\n    iziToast.show({\n      message: \"Please enter a search query\",\n      messageColor: '#fff',\n      backgroundColor: '#ef4040',\n      position: 'topCenter',\n      messageSize: '16px',\n      messageLineHeight: '150%',\n      iconColor: 'white'\n    });\n    return;\n  }\n\n  showLoader();\n  galleryList.innerHTML = '';\n  loadBtn.style.display = 'none';\n\n \n\n  serviceImage(currentKeyword)\n    .then(data => {\n      if (data.hits.length === 0) {\n        iziToast.show({\n          message: \"Sorry, there are no images matching your search query. Please try again!\",\n          messageColor: '#fff',\n          backgroundColor: '#ef4040',\n          position: 'topCenter',\n          messageSize: '16px',\n          messageLineHeight: '150%',\n          iconColor: 'white'\n        });\n        \n      } else {\n        galleryList.innerHTML = createMarkup(data.hits);\n        const lightboxOptions = {\n          captionDelay: 250,\n          captionsData: 'alt',\n          captionPosition: 'bottom',\n        };\n\n        const lightbox = new SimpleLightbox('.gallery a', lightboxOptions);\n        lightbox.refresh();\n\n        const totalPages = Math.ceil(data.totalHits / 15);\n\n        if (page < totalPages) {\n          loadBtn.style.display = 'block';\n          endMsg.style.display = 'none';\n        }\n      }\n         if (data.hits.length < 15) {\n\n      loadBtn.style.display = 'none';\n      endMsg.style.display = 'block';\n   \n      }\n    })\n    .catch(error => {\n      galleryList.innerHTML = '';\n      iziToast.show({\n        message: \"An error occurred while fetching images. Please try again later.\",\n        messageColor: '#fff',\n        backgroundColor: '#ef4040',\n        position: 'topCenter',\n        messageSize: '16px',\n        messageLineHeight: '150%',\n        iconColor: 'white'\n      });\n    })\n    .finally(() => {\n      hideLoader();\n      searchImage.reset();\n    });\n}\n\nasync function loadMore() {\n  showLoader();\n\n  try {\n    page++;\n    const data = await serviceImage(currentKeyword, page);\n\n    if (data && data.hits && data.hits.length > 0) {\n      galleryList.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n      toggleLoadButton(data.totalHits);\n      smoothScrollToNextGroup();\n      \n     \n      \n    } else {\n      loadBtn.style.display = \"none\";\n      if (page === 1) {\n        iziToast.show({\n          message: \"Sorry, there are no images matching your search query. Please try again!\",\n          messageColor: '#fff',\n          backgroundColor: '#ef4040',\n          position: 'topCenter',\n          messageSize: '16px',\n          messageLineHeight: '150%',\n          iconColor: 'white'\n        });\n      } else {\n        endMsg.style.display = 'block'; \n        loadBtn.style.display = 'none';\n        iziToast.show({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          messageColor: '#fff',\n          backgroundColor: '#ef4040',\n          position: 'topCenter',\n          messageSize: '16px',\n          messageLineHeight: '150%',\n          iconColor: 'white'\n        });\n      }\n    }\n  \n  } catch (error) {\n    loadBtn.style.display = \"none\";\n    iziToast.show({\n      message: \"An error occurred while fetching images. Please try again later.\",\n      messageColor: '#fff',\n      backgroundColor: '#ef4040',\n      position: 'topCenter',\n      messageSize: '16px',\n      messageLineHeight: '150%',\n      iconColor: 'white'\n    });\n  } finally {\n    loadBtn.disabled = false;\n    hideLoader();\n  }\n}\n\nfunction toggleLoadButton(totalHits) {\n  if (page * 15 >= totalHits) {\n    loadBtn.style.display = 'none';\n    endMsg.style.display = 'block';\n     iziToast.show({\n      message: \"You've reached the end of search results.\",\n      messageColor: '#fff',\n      backgroundColor: '#ef4040',\n      position: 'topCenter',\n      messageSize: '16px',\n      messageLineHeight: '150%',\n      iconColor: 'white'\n    });\n  } else {\n    loadBtn.style.display = 'block';\n    endMsg.style.display = 'none';\n  }\n}\n\nfunction smoothScrollToNextGroup() {\n  const firstGalleryItem = document.querySelector('.gallery a');\n  if (firstGalleryItem) {\n    const galleryItemHeight = firstGalleryItem.getBoundingClientRect().height;\n    window.scrollBy({\n      top: galleryItemHeight * 2,\n      behavior: 'smooth'\n    });\n  }\n}\n"],"names":["createMarkup","arr","webformatURL","tags","largeImageURL","likes","views","comments","downloads","API_KEY","serviceImage","image","page","parameters","response","axios","error","searchImage","galleryList","button","loader","loadBtn","endMsg","loadMore","handleSearch","searchInput","currentKeyword","showLoader","hideLoader","evt","iziToast","data","lightboxOptions","SimpleLightbox","totalPages","toggleLoadButton","smoothScrollToNextGroup","totalHits","firstGalleryItem","galleryItemHeight"],"mappings":"0vBAGO,SAASA,EAAaC,EAAK,CAClC,OAAOA,EAAI,IAAI,CAAC,CAAE,aAAAC,EAAc,KAAAC,EAAM,cAAAC,EAAe,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,KAC3D;AAAA,wCACsBJ,CAAa;AAAA;AAAA,kBAEnCF,CAAY;AAAA,kBACZC,CAAI;AAAA;AAAA;AAAA,yFAGmEE,CAAK;AAAA,0FACJC,CAAK;AAAA,6FACFC,CAAQ;AAAA,6FACRC,CAAS;AAAA;AAAA,YAI7F,EAAE,KAAK,EAAE,CAClB,CCnBA,MAAMC,EAAU,qCACT,eAAeC,EAAaC,EAAOC,EAAO,IAAK,CAElD,MAAMC,EAAa,CACjB,IAAKJ,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAMC,EACN,SAAU,EAChB,EAEE,GAAI,CACF,MAAME,EAAW,MAAMC,EAAM,IAAI,2BAA4B,CAC3D,OAAQF,CACd,CAAK,EAGD,GAAIC,EAAS,SAAW,IACtB,MAAM,IAAI,MAAMA,EAAS,UAAU,EAErC,OAAOA,EAAS,IACjB,OACME,EAAO,CACZ,MAAMA,CAEP,CACH,CCrBA,MAAMC,EAAc,SAAS,cAAc,cAAc,EACnDC,EAAc,SAAS,cAAc,UAAU,EAC/CC,EAAS,SAAS,cAAc,aAAa,EAC7CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,YAAY,EAC7CC,EAAS,SAAS,cAAc,cAAc,EAEpDD,EAAQ,iBAAiB,QAASE,CAAQ,EAC1CJ,EAAO,iBAAiB,QAASK,CAAY,EAE7C,MAAMC,EAAc,SAAS,cAAc,oBAAoB,EAC/DA,EAAY,iBAAiB,QAAS,IAAM,CAC1Cb,EAAO,EACPM,EAAY,UAAY,GACxBG,EAAQ,MAAM,QAAU,MAC1B,CAAC,EAEDJ,EAAY,iBAAiB,SAAUO,CAAY,EAEnD,IAAIZ,EAAO,EACPc,EAAiB,GACrBJ,EAAO,MAAM,QAAU,OACvBD,EAAQ,MAAM,QAAU,OAExB,SAASM,GAAa,CACpBP,EAAO,MAAM,QAAU,OACzB,CAEA,SAASQ,GAAa,CACpBR,EAAO,MAAM,QAAU,MACzB,CAEA,SAASI,EAAaK,EAAK,CAIzB,GAHAA,EAAI,eAAc,EAElBH,EADmB,SAAS,cAAc,oBAAoB,EAClC,MAAM,OAC9BA,IAAmB,GAAI,CACzBI,EAAS,KAAK,CACZ,QAAS,8BACT,aAAc,OACd,gBAAiB,UACjB,SAAU,YACV,YAAa,OACb,kBAAmB,OACnB,UAAW,OACjB,CAAK,EACD,MACD,CAEDH,IACAT,EAAY,UAAY,GACxBG,EAAQ,MAAM,QAAU,OAIxBX,EAAagB,CAAc,EACxB,KAAKK,GAAQ,CACZ,GAAIA,EAAK,KAAK,SAAW,EACvBD,EAAS,KAAK,CACZ,QAAS,2EACT,aAAc,OACd,gBAAiB,UACjB,SAAU,YACV,YAAa,OACb,kBAAmB,OACnB,UAAW,OACrB,CAAS,MAEI,CACLZ,EAAY,UAAYlB,EAAa+B,EAAK,IAAI,EAC9C,MAAMC,EAAkB,CACtB,aAAc,IACd,aAAc,MACd,gBAAiB,QAC3B,EAEyB,IAAIC,EAAe,aAAcD,CAAe,EACxD,QAAO,EAEhB,MAAME,EAAa,KAAK,KAAKH,EAAK,UAAY,EAAE,EAE5CnB,EAAOsB,IACTb,EAAQ,MAAM,QAAU,QACxBC,EAAO,MAAM,QAAU,OAE1B,CACMS,EAAK,KAAK,OAAS,KAE1BV,EAAQ,MAAM,QAAU,OACxBC,EAAO,MAAM,QAAU,QAG7B,CAAK,EACA,MAAMN,GAAS,CACdE,EAAY,UAAY,GACxBY,EAAS,KAAK,CACZ,QAAS,mEACT,aAAc,OACd,gBAAiB,UACjB,SAAU,YACV,YAAa,OACb,kBAAmB,OACnB,UAAW,OACnB,CAAO,CACP,CAAK,EACA,QAAQ,IAAM,CACbF,IACAX,EAAY,MAAK,CACvB,CAAK,CACL,CAEA,eAAeM,GAAW,CACxBI,IAEA,GAAI,CACFf,IACA,MAAMmB,EAAO,MAAMrB,EAAagB,EAAgBd,CAAI,EAEhDmB,GAAQA,EAAK,MAAQA,EAAK,KAAK,OAAS,GAC1Cb,EAAY,mBAAmB,YAAalB,EAAa+B,EAAK,IAAI,CAAC,EACnEI,EAAiBJ,EAAK,SAAS,EAC/BK,MAKAf,EAAQ,MAAM,QAAU,OACpBT,IAAS,EACXkB,EAAS,KAAK,CACZ,QAAS,2EACT,aAAc,OACd,gBAAiB,UACjB,SAAU,YACV,YAAa,OACb,kBAAmB,OACnB,UAAW,OACrB,CAAS,GAEDR,EAAO,MAAM,QAAU,QACvBD,EAAQ,MAAM,QAAU,OACxBS,EAAS,KAAK,CACZ,QAAS,6DACT,aAAc,OACd,gBAAiB,UACjB,SAAU,YACV,YAAa,OACb,kBAAmB,OACnB,UAAW,OACrB,CAAS,GAIN,MAAe,CACdT,EAAQ,MAAM,QAAU,OACxBS,EAAS,KAAK,CACZ,QAAS,mEACT,aAAc,OACd,gBAAiB,UACjB,SAAU,YACV,YAAa,OACb,kBAAmB,OACnB,UAAW,OACjB,CAAK,CACL,QAAY,CACRT,EAAQ,SAAW,GACnBO,GACD,CACH,CAEA,SAASO,EAAiBE,EAAW,CAC/BzB,EAAO,IAAMyB,GACfhB,EAAQ,MAAM,QAAU,OACxBC,EAAO,MAAM,QAAU,QACtBQ,EAAS,KAAK,CACb,QAAS,4CACT,aAAc,OACd,gBAAiB,UACjB,SAAU,YACV,YAAa,OACb,kBAAmB,OACnB,UAAW,OACjB,CAAK,IAEDT,EAAQ,MAAM,QAAU,QACxBC,EAAO,MAAM,QAAU,OAE3B,CAEA,SAASc,GAA0B,CACjC,MAAME,EAAmB,SAAS,cAAc,YAAY,EAC5D,GAAIA,EAAkB,CACpB,MAAMC,EAAoBD,EAAiB,sBAAqB,EAAG,OACnE,OAAO,SAAS,CACd,IAAKC,EAAoB,EACzB,SAAU,QAChB,CAAK,CACF,CACH"}